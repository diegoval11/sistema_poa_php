import{_ as l,C as r,o as e,c as d,j as s,a as i,b as p,w as t,E as o,a3 as h,a2 as k}from"./chunks/framework.BNd_iFDH.js";const C=JSON.parse('{"title":"Panel de Aprobación (Admin)","description":"","frontmatter":{},"headers":[],"relativePath":"modules/admin.md","filePath":"modules/admin.md","lastUpdated":null}'),c={name:"modules/admin.md"};function E(m,a,g,b,u,A){const n=r("Mermaid");return e(),d("div",null,[a[1]||(a[1]=s("h1",{id:"panel-de-aprobacion-admin",tabindex:"-1"},[i("Panel de Aprobación (Admin) "),s("a",{class:"header-anchor",href:"#panel-de-aprobacion-admin","aria-label":'Permalink to "Panel de Aprobación (Admin)"'},"​")],-1)),a[2]||(a[2]=s("p",null,[s("code",null,"ProyectoAdminController"),i(" — Gestiona el flujo de aprobación/rechazo de proyectos enviados por las unidades.")],-1)),a[3]||(a[3]=s("h2",{id:"ciclo-de-aprobacion",tabindex:"-1"},[i("Ciclo de Aprobación "),s("a",{class:"header-anchor",href:"#ciclo-de-aprobacion","aria-label":'Permalink to "Ciclo de Aprobación"'},"​")],-1)),(e(),p(h,null,{default:t(()=>[o(n,{id:"mermaid-9",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20A(%5BProyecto%20ENVIADO%5D)%20--%3E%20B%5BAdmin%20accede%20al%20detalle%5CnProyectoAdminController%3A%3Adetalle%5D%0A%20%20%20%20B%20--%3E%20C%7BDecisi%C3%B3n%20del%20Admin%7D%0A%20%20%20%20C%20--%20Aprobar%20--%3E%20D%5Bestado%20%3D%20APROBADO%5Cnaprobado_por%20%3D%20Auth%3A%3Aid%5Cnfecha_aprobacion%20%3D%20now%5D%0A%20%20%20%20C%20--%20Rechazar%20--%3E%20E%5Bestado%20%3D%20RECHAZADO%5Cnmotivo_rechazo%20%3D%20requerido%2C%20min%2010%20chars%5D%0A%20%20%20%20D%20--%3E%20F%5BCache%3A%3Aflush%5CnDashboard%20se%20actualiza%5D%0A%20%20%20%20E%20--%3E%20F%0A%20%20%20%20E%20--%3E%20G%5BUnidad%20ve%20el%20motivo%5Cny%20puede%20corregir%5D%0A%20%20%20%20G%20--%3E%20H(%5BUnidad%20reenv%C3%ADa%20%E2%86%92%20ENVIADO%5D)%0A"})]),fallback:t(()=>[...a[0]||(a[0]=[i(" Loading... ",-1)])]),_:1})),a[4]||(a[4]=k(`<h2 id="metricas-calculadas-en-la-vista-de-detalle" tabindex="-1">Métricas calculadas en la Vista de Detalle <a class="header-anchor" href="#metricas-calculadas-en-la-vista-de-detalle" aria-label="Permalink to &quot;Métricas calculadas en la Vista de Detalle&quot;">​</a></h2><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Conteo de actividades del proyecto</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$total_actividades </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PoaActividad</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">whereHas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;meta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($q) =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;poa_proyecto_id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, $proyectoId)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Presupuesto total (suma de costo_estimado de todas las actividades)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$presupuesto_total </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PoaActividad</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">whereHas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;costo_estimado&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Total de evidencias adjuntadas en todo el proyecto</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$total_evidencias </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> PoaEvidencia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">whereHas</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;actividad.meta&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="panel-administrativo-completo" tabindex="-1">Panel Administrativo Completo <a class="header-anchor" href="#panel-administrativo-completo" aria-label="Permalink to &quot;Panel Administrativo Completo&quot;">​</a></h2><p><code>AdminPanelController</code> ofrece CRUD completo para:</p><table tabindex="0"><thead><tr><th>Entidad</th><th>Operaciones</th></tr></thead><tbody><tr><td><strong>Proyectos</strong></td><td>Ver, editar, eliminar, restaurar (soft delete), vaciar papelera</td></tr><tr><td><strong>Usuarios</strong></td><td>Crear, editar, eliminar</td></tr><tr><td><strong>Unidades</strong></td><td>Crear, editar, eliminar</td></tr><tr><td><strong>Metas</strong></td><td>Crear, editar, eliminar (catálogo global)</td></tr><tr><td><strong>Actividades</strong></td><td>Crear, editar, eliminar (catálogo global)</td></tr></tbody></table><h2 id="dashboard-de-estadisticas" tabindex="-1">Dashboard de Estadísticas <a class="header-anchor" href="#dashboard-de-estadisticas" aria-label="Permalink to &quot;Dashboard de Estadísticas&quot;">​</a></h2><p><code>StatisticsController</code> provee una vista global del sistema con:</p><ul><li>Cumplimiento por unidad</li><li>Comparativas trimestrales</li><li>Exportación a Excel y PDF (<code>ExportController</code>)</li></ul>`,8))])}const D=l(c,[["render",E]]);export{C as __pageData,D as default};
