import{_ as e,o as s,c as n,a2 as o}from"./chunks/framework.BNd_iFDH.js";const m=JSON.parse('{"title":"Exportaciones Excel y PDF","description":"","frontmatter":{},"headers":[],"relativePath":"modules/exports.md","filePath":"modules/exports.md","lastUpdated":null}'),t={name:"modules/exports.md"};function i(d,a,l,r,c,p){return s(),n("div",null,[...a[0]||(a[0]=[o(`<h1 id="exportaciones-excel-y-pdf" tabindex="-1">Exportaciones Excel y PDF <a class="header-anchor" href="#exportaciones-excel-y-pdf" aria-label="Permalink to &quot;Exportaciones Excel y PDF&quot;">​</a></h1><p>El sistema genera reportes oficiales del POA en dos formatos desde el panel de Admin.</p><h2 id="tipos-de-exportacion" tabindex="-1">Tipos de Exportación <a class="header-anchor" href="#tipos-de-exportacion" aria-label="Permalink to &quot;Tipos de Exportación&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Reporte</th><th>Servicio</th><th>Descripción</th></tr></thead><tbody><tr><td><strong>POA Completo</strong></td><td><code>PoaExcelService</code></td><td>Detalle mensual completo con fórmulas de cumplimiento trimestrales y anuales</td></tr><tr><td><strong>POA Resumido</strong></td><td><code>PoaExcelResumidoService</code></td><td>Vista condensada con totales de recursos y resumen ejecutivo</td></tr><tr><td><strong>Detallado Admin</strong></td><td><code>ProyectoDetalladoExport</code></td><td>Exportación por proyecto individual con evidencias</td></tr><tr><td><strong>Global Trimestral</strong></td><td><code>ExportController</code></td><td>Estadísticas de todas las unidades en un período trimestral</td></tr></tbody></table><h2 id="acceso-a-las-exportaciones" tabindex="-1">Acceso a las Exportaciones <a class="header-anchor" href="#acceso-a-las-exportaciones" aria-label="Permalink to &quot;Acceso a las Exportaciones&quot;">​</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Por unidad (desde UnidadController):</span></span>
<span class="line"><span>GET /admin/unidades/{id}/exportar-poa          → POA Completo</span></span>
<span class="line"><span>GET /admin/unidades/{id}/exportar-poa-resumido → POA Resumido</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Por proyecto individual (desde ProyectoAdminController):</span></span>
<span class="line"><span>GET /admin/proyectos/{id}/export-excel → Proyecto Detallado (.xlsx)</span></span>
<span class="line"><span>GET /admin/proyectos/{id}/export-pdf   → Proyecto Detallado (.pdf)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Global (desde ExportController):</span></span>
<span class="line"><span>GET /admin/statistics/export-excel → Trimestral (.xlsx)</span></span>
<span class="line"><span>GET /admin/statistics/export-pdf   → Trimestral (.pdf)</span></span>
<span class="line"><span>GET /admin/unidades/export-excel   → Por unidades (.xlsx)</span></span>
<span class="line"><span>GET /admin/unidades/export-pdf     → Por unidades (.pdf)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="nomenclatura-de-archivos-generados" tabindex="-1">Nomenclatura de Archivos Generados <a class="header-anchor" href="#nomenclatura-de-archivos-generados" aria-label="Permalink to &quot;Nomenclatura de Archivos Generados&quot;">​</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POA_Detallado_{Nombre_Unidad}_{Año}_{FechaHoy}.xlsx</span></span>
<span class="line"><span>// Ejemplo: POA_Detallado_Obras_Publicas_2026_20260223.xlsx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="columna-medio-de-verificacion-o-causal-del-incumplimiento" tabindex="-1">Columna &quot;Medio de Verificación o Causal del Incumplimiento&quot; <a class="header-anchor" href="#columna-medio-de-verificacion-o-causal-del-incumplimiento" aria-label="Permalink to &quot;Columna &quot;Medio de Verificación o Causal del Incumplimiento&quot;&quot;">​</a></h2><p>En el Excel se muestra dinámicamente:</p><ul><li>Si <code>cantidad_ejecutada &gt; 0</code> → muestra el <strong>medio de verificación</strong> de la actividad.</li><li>Si <code>cantidad_ejecutada = 0</code> y <code>cantidad_programada &gt; 0</code> → muestra la <strong>causal del desvío</strong>.</li><li>Si no hay programación para ese mes → celda vacía.</li></ul><div class="tip custom-block"><p class="custom-block-title">Extensión</p><p>Para agregar un nuevo formato de exportación, crea un nuevo Service en <code>app/Services/</code> siguiendo el patrón de <code>PoaExcelService</code>, e intégralo en <code>UnidadController</code> o <code>ExportController</code>.</p></div>`,12)])])}const b=e(t,[["render",i]]);export{m as __pageData,b as default};
